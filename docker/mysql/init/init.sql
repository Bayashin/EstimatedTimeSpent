USE testdb;

CREATE TABLE IF NOT EXISTS edited_logs (
    id INT NOT NULL AUTO_INCREMENT,
    user_id INT NOT NULL,
    date DATE NOT NULL,
    reporting TIME NOT NULL,
    leaving TIME NOT NULL,
    PRIMARY KEY (id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS clusters (
    id INT NOT NULL AUTO_INCREMENT,
    date DATE NOT NULL,
    reporting BOOLEAN NOT NULL,
    average float NOT NULL,
    sd float NOT NULL,
    count INT NOT NULL,
    user_id INT NOT NULL,
    PRIMARY KEY (id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS users (
    id INT NOT NULL AUTO_INCREMENT,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP NULL DEFAULT NULL,
    uuid VARCHAR(255) NOT NULL,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    role INT NOT NULL,
    beacon_id INT NOT NULL,
    community_id INT NOT NULL,
    PRIMARY KEY (id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE logs (
    id bigint unsigned NOT NULL AUTO_INCREMENT,
    created_at datetime(3) DEFAULT CURRENT_TIMESTAMP(3),
    updated_at datetime(3) DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3),
    deleted_at datetime(3) DEFAULT NULL,
    room_id bigint DEFAULT NULL,
    start_at datetime(3) DEFAULT NULL,
    end_at datetime(3) DEFAULT NULL,
    user_id bigint DEFAULT NULL,
    rssi bigint DEFAULT NULL,
    PRIMARY KEY (id),
    KEY deleted_at (deleted_at)
);

INSERT INTO users (
    uuid, name, email, role, beacon_id, community_id
    )
VALUES
    ('1', 'John Doe', 'hoge@hoge.com', 1, 1, 1);

INSERT INTO edited_logs (
    user_id, date, reporting, leaving
    )
VALUES
    (1, '2023-05-22', '19:18:35', '19:24:45'),
    (1, '2023-05-23', '08:56:40', '10:23:32'),
    (1, '2023-05-30', '08:56:38', '18:56:10'),
    (1, '2023-06-01', '16:31:09', '18:27:59'),
    (1, '2023-06-08', '13:12:01', '21:06:24'),
    (1, '2023-06-12', '08:35:59', '13:19:50'),
    (1, '2023-06-13', '08:47:21', '10:38:53'),
    (1, '2023-06-14', '18:21:15', '21:37:58'),
    (1, '2023-06-15', '12:54:05', '15:15:48'),
    (1, '2023-06-19', '12:12:47', '16:19:40'),
    (1, '2023-06-20', '09:07:57', '10:28:35'),
    (1, '2023-06-21', '19:17:59', '19:24:08'),
    (1, '2023-06-26', '13:25:04', '13:31:17'),
    (1, '2023-06-27', '09:36:04', '22:00:17'),
    (1, '2023-06-29', '10:13:40', '22:28:30'),
    (1, '2023-06-30', '16:44:31', '16:50:47'),
    (1, '2023-07-06', '17:39:19', '21:15:43'),
    (1, '2023-07-07', '04:44:18', '05:02:45'),
    (1, '2023-07-11', '08:59:19', '21:38:39'),
    (1, '2023-07-12', '17:56:53', '21:19:55'),
    (1, '2023-07-13', '00:36:36', '16:39:13'),
    (1, '2023-07-15', '12:25:19', '17:16:05'),
    (1, '2023-07-16', '15:00:50', '19:32:04'),
    (1, '2023-07-18', '09:02:06', '10:34:50'),
    (1, '2023-07-19', '18:03:39', '22:10:02'),
    (1, '2023-07-20', '13:14:12', '19:05:39'),
    (1, '2023-07-21', '09:01:35', '18:34:20'),
    (1, '2023-07-24', '17:45:47', '20:19:39'),
    (1, '2023-07-25', '08:49:32', '10:28:37'),
    (1, '2023-08-01', '10:24:45', '22:40:45'),
    (1, '2023-08-02', '10:39:43', '22:35:16'),
    (1, '2023-08-03', '00:50:35', '21:38:57'),
    (1, '2023-08-04', '02:36:11', '12:15:26'),
    (1, '2023-08-06', '10:52:23', '20:18:33'),
    (1, '2023-08-07', '21:13:06', '21:25:24'),
    (1, '2023-08-08', '10:27:50', '20:49:39'),
    (1, '2023-08-09', '17:09:02', '03:15:36'),
    (1, '2023-08-10', '20:03:02', '22:55:08'),
    (1, '2023-08-11', '03:25:32', '16:16:41'),
    (1, '2023-08-17', '11:45:53', '12:53:50'),
    (1, '2023-08-29', '10:41:21', '19:20:40'),
    (1, '2023-08-31', '11:32:07', '20:18:40'),
    (1, '2023-09-05', '10:52:13', '15:27:23'),
    (1, '2023-09-15', '16:53:21', '21:05:57'),
    (1, '2023-09-17', '07:11:54', '08:25:52'),
    (1, '2023-09-18', '16:15:06', '18:12:56'),
    (1, '2023-09-19', '10:41:12', '20:10:59'),
    (1, '2023-09-20', '11:17:40', '11:23:51'),
    (1, '2023-10-03', '15:09:04', '16:05:33'),
    (1, '2023-10-05', '20:24:23', '20:30:36'),
    (1, '2023-10-06', '19:40:36', '19:46:47'),
    (1, '2023-10-07', '02:52:34', '22:46:28'),
    (1, '2023-10-09', '17:22:42', '22:43:34'),
    (1, '2023-10-16', '12:06:51', '13:09:02'),
    (1, '2023-10-17', '09:21:12', '21:47:35'),
    (1, '2023-10-18', '12:19:19', '15:44:00'),
    (1, '2023-10-20', '12:15:01', '21:45:02'),
    (1, '2023-10-23', '16:18:50', '20:01:57'),
    (1, '2023-10-24', '08:59:49', '20:42:50'),
    (1, '2023-10-26', '11:31:42', '17:06:48'),
    (1, '2023-10-27', '12:11:34', '21:29:19'),
    (1, '2023-11-08', '13:47:25', '21:18:52'),
    (1, '2023-11-09', '10:41:01', '10:47:12'),
    (1, '2023-11-10', '14:34:56', '20:21:55'),
    (1, '2023-11-12', '13:55:07', '23:18:16'),
    (1, '2023-11-13', '13:14:03', '10:43:00'),
    (1, '2023-11-15', '11:46:21', '23:38:30'),
    (1, '2023-11-16', '00:21:58', '22:26:16'),
    (1, '2023-11-17', '14:17:06', '20:58:54'),
    (1, '2023-11-18', '00:22:57', '08:55:43'),
    (1, '2023-11-22', '13:13:30', '13:50:34'),
    (1, '2023-11-28', '09:04:52', '10:44:36'),
    (1, '2023-11-29', '12:20:43', '16:03:26'),
    (1, '2023-11-30', '09:02:44', '09:15:05'),
    (1, '2023-12-02', '09:27:18', '13:21:35'),
    (1, '2023-12-04', '16:30:51', '22:28:56'),
    (1, '2023-12-05', '08:33:17', '13:00:31'),
    (1, '2023-12-06', '12:19:17', '14:35:18'),
    (1, '2023-12-07', '15:08:56', '20:55:15'),
    (1, '2023-12-11', '16:25:35', '19:43:04'),
    (1, '2023-12-12', '09:15:37', '10:36:13'),
    (1, '2023-12-13', '12:41:53', '16:48:54'),
    (1, '2023-12-14', '09:14:06', '21:52:38'),
    (1, '2023-12-15', '15:44:05', '22:43:18'),
    (1, '2023-12-18', '16:16:09', '08:12:32'),
    (1, '2023-12-19', '08:37:15', '12:58:21'),
    (1, '2023-12-21', '09:06:11', '22:53:02'),
    (1, '2023-12-25', '16:13:12', '00:00:00');